
+---------------------------------------------------------+----------------------+
|                GPT2 WEIGHTS SIZE                        | DTYPES               |
|--------------------------------------------------------------------------------+
|  weight name   |  Gpt2 |  Gpt2-md | Gpt2-lg  | Gpt2-xl  | Default  | Quantized |
|                |  117M |  345     |  750     |  1.5B    |  dtype   |   dtype   |
|----------------|----------------------------------------|----------|-----------|
|  token_emb     | 78MB  | 102MB    | 128MB    |  161MB   |  F16     |  Qint8    |
|  pos_emb       |  2MB  |   2MB    |   3MB    |    4MB   |  F16     |  Qint8    |
|  b_ln1_2_w     |  0MB  |   0MB    |   0MB    |    0MB   |  F16     |  F16      |
|  b_ln1_2_b     |  0MB  |   0MB    |   0MB    |    0MB   |  F16     |  F16      |
|  b_attn_qkwp_w | 56MB  | 201MB    | 472MB    |  983MB   |  F16     |  Qint8    |
|  b_attn_qkwp_b |  0MB  |   0MB    |   0MB    |    0MB   |  F16     |  F16      |
|  b_mlp_fc_w    | 56MB  | 201MB    | 472MB    |  983MB   |  F16     |  Qint8    |
|  b_mlp_fc_b    |  0MB  |   0MB    |   0MB    |    0MB   |  F16     |  F16      |
|  b_mlp_proj_w  | 56MB  | 201MB    | 472MB    |  983MB   |  F16     |  Qint8    |
|  b_mlp_proj_b  |  0MB  |   0MB    |   0MB    |    0MB   |  F16     |  F16      |
|  lnf_w         |  0MB  |   0MB    |   0MB    |    0MB   |  F16     |  F16      |
|  lnf_b         |  0MB  |   0MB    |   0MB    |    0MB   |  F16     |  F16      |
|---------------------------------------------------------|----------------------|
|  TOT   [f16]   | 248MB |  705MB   | 1544MB   |  3110MB  |Compression ratios    |
|---------------------------------------------------------|----------------------|
|  TOT [Qi8_B8f] | 186MB |  529MB   | 1158MB   |  2332MB  | Qi8_B8f  : 0.75      |
|---------------------------------------------------------|----------------------|
|  TOT [Qi8_B32f]| 139MB |  395MB   |  864MB   |  1741MB  | Qi8_B32f : 0.5625    |             
|---------------------------------------------------------|----------------------|
|  TOT [Qi8_B32h]| 132MB |  375MB   |  820MB   |  1652MB  | Qi8_B32h : 0.53125   |
|---------------------------------------------------------|----------------------|
|  TOT [Qi8_B64h]| 128MB |  364MB   |  796MB   |  1603MB  | Qi8_B64h : 0.515625  |
+--------------------------------------------------------------------------------+



+--------------------------------------------------------------------------------+
|                GPT2 ACTIVS SIZE                         | DTYPES               |
|--------------------------------------------------------------------------------+
|  activs name   |  Gpt2 |  Gpt2-md | Gpt2-lg  | Gpt2-xl  | Default  | Quantized |
|                |  117M |  345     |  750     |  1.5B    |  dtype   |   dtype   |
|----------------|----------------------------------------|----------|-----------|
|  token_emb     |   2MB |   2MB    |    3MB   |     4MB  |  F16     |  Qint8    |-------------------------------+
|  pos_emb       |   0MB |   0MB    |    0MB   |     0MB  |  F16     |  Qint8    | assuming w.dtype == acv.dtype |
|  emb_res       |   2MB |   2MB    |    3MB   |     4MB  |  F16     |  Qint8    |-------------------------------+
|  b_ln_1        |  19MB |  50MB    |   95MB   |   158MB  |  F16     |  Qint8    |
|  b_attn_qkvp   |  75MB | 201MB    |  378MB   |   630MB  |  F16     |  Qint8    |
|  b_attn_qk     | 302MB | 806MB    | 1500MB   |  2500MB  |  F16     |  F16      |
|  b_attn_qkv    |  19MB |  50MB    |   95MB   |   158MB  |  F16     |  F16      |
|  b_res_1       |  19MB |  50MB    |   95MB   |   158MB  |  F16     |  F16      |
|  b_ln_2        |  19MB |  50MB    |   95MB   |   158MB  |  F16     |  F16      |
|  b_mlp_fc      |  75MB | 201MB    |  378MB   |   630MB  |  F16     |  Qint8    |
|  b_mlp_gelu    |  75MB | 201MB    |  378MB   |   630MB  |  F16     |  F16      |
|  b_mlp_proj    |  75MB | 201MB    |  378MB   |   630MB  |  F16     |  Qint8    |
|  b_res_2       |  19MB |  50MB    |   95MB   |   158MB  |  F16     |  F16      |
|  ln_f          |   2MB |   2MB    |    3MB   |    4MB   |  F16     |  F16      |---------------------------------------------+
|  emb_proj      |   1MB |   1MB    |    1MB   |    1MB   |  F16     |  F16      | assuming prediction not e.g calc perplexity |
|---------------------------------------------------------|----------------------|---------------------------------------------+
|  TOT   [f16]   | 705MB | 1870MB   | 3500MB   |  5820MB  |Compression ratios    |
|---------------------------------------------------------|----------------------|
|  TOT [Qi8_B8f] | 529MB | 1403MB   | 2625MB   |  4365MB  | Qi8_B8f  : 0.75      |
|---------------------------------------------------------|----------------------|
|  TOT [Qi8_B32f]| 397MB | 1052MB   | 1970MB   |  3275MB  | Qi8_B32f : 0.5625    |             
|---------------------------------------------------------|----------------------|
|  TOT [Qi8_B32h]| 375MB |  994MB   | 1860MB   |  3092MB  | Qi8_B32h : 0.53125   |
|---------------------------------------------------------|----------------------|
|  TOT [Qi8_B64h]| 364MB |  965MB   | 1805MB   |  3000MB  | Qi8_B64h : 0.515625  |
|---------------------------------------------------------|----------------------+
|  TOT [f16][512]| 290MB |  736MB   | 1390MB   |  2286MB  |
|---------------------------------------------------------|
|  TOT [Q8_B32h] | 155MB |  391MB   | 739MB   |  1215MB   |
+---------------------------------------------------------+


+----------------------------------------------------------+
|      Gpt2 FP16 and Qint8 comparison                      |
+----------------------------------------------------------|
| Prop.  | FP16    | Q_B32   | Q_B64   | Q_B128  | Q_B256  |
+----------------------------------------------------------+
| size   | 250MB   | 133MB   | 129MB   | 127MB   | 126MB   |
| activ  | 630MB   | 325MB   | 320MB   | 318MB   | 316MB   |
| cpu pf | 168ms   | 90ms    | 72ms    | 62ms    | 58ms    |
| smd pf | 45ms    | 57ms    | 47ms    | 43ms    | 38ms    |
| Perp   | 24.9429 | 30.0606 | 30.0288 | 33.9144 | 41.3293 |
-----------------------------------------------------------+
